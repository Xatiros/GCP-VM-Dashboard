# nginx.conf (para el frontend, en la raíz del repo)
# Configuración principal de Nginx para una aplicación de una sola página (SPA)
events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    keepalive_timeout  65;

    server {
        listen 80; # Nginx escuchará en el puerto 80

        # La raíz de los archivos web dentro del contenedor Docker
        # donde el Dockerfile copió el contenido de la carpeta 'dist'
        root /usr/share/nginx/html;

        # Define el archivo de índice predeterminado
        index index.html index.htm;

        # Bloque de ubicación principal para manejar las solicitudes
        location / {
            # Intenta servir el archivo directamente si existe ($uri)
            # o el directorio si existe ($uri/)
            # Si no se encuentra, redirige internamente a /index.html
            # Esto es esencial para las aplicaciones de una sola página (SPA)
            # que manejan su propio enrutamiento del lado del cliente.
            try_files $uri $uri/ /index.html;
        }

        # Manejo de errores
        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
            root /usr/share/nginx/html;
        }

        # Opcional: Configuración para cachéo de activos estáticos
        # location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|eot|ttf|woff|woff2)$ {
        #     expires 30d;
        #     add_header Cache-Control "public, no-transform";
        # }
    }
}